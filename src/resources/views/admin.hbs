{{!--   <link href="/icofont/icofont.min.css" rel="stylesheet">
  <link href="/icofont/icofont.css" rel="stylesheet"> --}}
<link rel="stylesheet" href="/css/admin.css">


<div class="container" style="margin-top: 100px;">
  <a href="/sessionLogout">Log out</a>
  <button class="accordion">Quản lý người dùng</button>
  <div class="panel">
    <!--===== CRUD TABLE =======-->

    <body>

      <div class="container-xl">
        <div class="table-responsive">
          <div class="table-wrapper">
            <div class="table-title">
              <div class="row">
                <div class="col-sm-6">
                  <h2>QUẢN LÝ <b>NGƯỜI DÙNG</b></h2>
                </div>
                <div class="col-sm-6">
                  <a href="#addEmployeeModal" class="btn btn-success" data-toggle="modal"><i
                      class="icofont-ui-add"></i><span>Thêm người dùng</span></a>
                  {{!-- <a href="#deleteEmployeeModal" class="btn btn-danger" data-toggle="modal"><i
                      class="icofont-ui-delete"></i> <span>Xóa người dùng</span></a> --}}
                </div>
              </div>
            </div>
            <table class="table">
              <thead>
                <tr>
                  <th>
                    <span class="custom-checkbox">
                      <input type="checkbox" id="selectAll">
                      <label for="selectAll"></label>
                    </span>
                  </th>
                  <th scope="col">Số thứ tự</th>
                  <th scope="col">Bệnh Nhân</th>
                  <th scope="col">Tuổi</th>
                  <th scope="col">Địa Điểm</th>
                  <th scope="col">Tình trạng</th>
                  <th scope="col">Quốc tịch</th>
                  <th scope="col">Lựa chọn</th>
                </tr>
              </thead>
              <tbody>
                {{#each statistical}}
                <tr>
                  <td>
                    <span class="custom-checkbox">
                      <input type="checkbox" id="checkbox2" name="options[]" value="1">
                      <label for="checkbox2"></label>
                    </span>
                  </td>
                  <td scope="row">{{sum @index 1}}</td>
                  <td scope="row">{{patient}}</td>
                  <td scope="row">{{age}}</td>
                  <td scope="row">{{address}}</td>
                  <td scope="row">{{state}}</td>
                  <td scope="row">{{nationality}}</td>
                  <td>
                    <a href="#update-patient-modal" class="edit" data-toggle="modal" data-patient="{{patient}}"><i class="icofont-edit"
                        data-toggle="tooltip" title="Edit"></i></a>
                    <a href="#delete-patient-modal" class="delete" data-toggle="modal" data-patient="{{patient}}"><i class="icofont-ui-delete"
                        data-toggle="tooltip" title="Delete"></i></a>
                  </td>
                </tr>
                {{/each}}
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Add Modal -->
      <div id="addEmployeeModal" class="modal fade">
        <div class="modal-dialog">
          <div class="modal-content">
            <form action="/admin" method="POST">
              <div class="modal-header">
                <h4 class="modal-title">Thêm bệnh nhân</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              </div>
              <div class="modal-body">
                <div class="form-group">
                  <input type="text" class="form-control" name="patient" placeholder="Bệnh Nhân">
                </div>
                <div class="form-group">
                  <input type="text" class="form-control" name="age" placeholder="Tuổi">
                </div>
                <div class="form-group">
                  <input type="text" class="form-control" name="address" placeholder="Địa Điểm">
                </div>
                <div class="form-group">
                  <input type="text" class="form-control" name="state" placeholder="Tình trạng">
                </div>
                <div class="form-group">
                  <input type="text" class="form-control" name="nationality" placeholder="Quốc tịch">
                </div>
              </div>
              <div class="modal-footer">
                <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                <input type="submit" class="btn btn-success" value="Add">
              </div>
            </form>
          </div>
        </div>
      </div>

      <!-- Delete Modal HTML -->
      <div class="modal fade" id="delete-patient-modal" tabindex="-1" role="dialog" aria-labelledby="exampleModalLabel"
        aria-hidden="true">
        <div class="modal-dialog" role="document">
          <div class="modal-content">
            <div class="modal-header">
              <h5 class="modal-title" id="exampleModalLabel">Xóa bệnh nhân?</h5>
              <button type="button" class="close" data-dismiss="modal" aria-label="Close">
                <span aria-hidden="true">&times;</span>
              </button>
            </div>
            <div class="modal-body">
              Bạn chắc chắc muốn xóa bệnh nhân này!!!
            </div>
            <div class="modal-footer">
              <button type="button" class="btn btn-secondary" data-dismiss="modal">Hủy</button>
              <button id="btn-delete-statistics" type="button" class="btn btn-danger">Xóa bỏ</button>
            </div>
          </div>
        </div>
      </div>
      {{!-- Delete form hide --}}
      <form name="delete-statistics-form" action="/admin/{{patient}}?_method=DELETE" method="POST"></form>

      <!-- Edit Modal HTML -->
      <div id="update-patient-modal" class="modal fade">
        <div class="modal-dialog">
          <div class="modal-content">
            <form name="update-statistics-form" action="/admin/{{patient}}?_method=PUT" method="POST">
              <div class="modal-header">
                <h4 class="modal-title">Edit Employee</h4>
                <button type="button" class="close" data-dismiss="modal" aria-hidden="true">&times;</button>
              </div>
              <div class="modal-body">
                <div class="form-group">
                  <label>Bệnh Nhân</label>
                  <input type="text" class="form-control" name="patient" required>
                </div>
                <div class="form-group">
                  <label>Tuổi</label>
                  <input type="text" class="form-control" name="age" required>
                </div>
                <div class="form-group">
                  <label>Địa chỉ</label>
                  <input type="text" class="form-control" name="address" required>
                </div>
                <div class="form-group">
                  <label>Tình Trạng</label>
                  <input type="text" class="form-control" name="state" required>
                </div>
                <div class="form-group">
                  <label>Quốc tịch</label>
                  <input type="text" class="form-control" name="nationality" required>
                </div>
              </div>
              <div class="modal-footer">
                <input type="button" class="btn btn-default" data-dismiss="modal" value="Cancel">
                <input type="submit" id="btn-update-statistics" class="btn btn-info" value="Save">
              </div>
            </form>
          </div>
        </div>
      </div>
      <!--==== End CRUD TABLE ====-->
  </div>

  <button class="accordion">Quản lý bảng dữ liệu Firebase</button>
  <div class="panel">

    <!--Retools o day-->

  </div>

</div>


<script>
  var acc = document.getElementsByClassName("accordion");
  var i;

  for (i = 0; i < acc.length; i++) {
    acc[i].addEventListener("click", function () {
      this.classList.toggle("active");
      var panel = this.nextElementSibling;
      if (panel.style.maxHeight) {
        panel.style.maxHeight = null;
      } else {
        panel.style.maxHeight = panel.scrollHeight + "px";
      }
    });
  }

  //btn delete
  document.addEventListener('DOMContentLoaded', function () {
    var patientID;
    var deleteForm = document.forms['delete-statistics-form'];
    var btnDeleteStatistics = document.getElementById('btn-delete-statistics');
    $('#delete-patient-modal').on('show.bs.modal', function (event) {
      var button = $(event.relatedTarget)
      patientID = button.data('patient');
      console.log(patientID);
    });
    btnDeleteStatistics.onclick = function () {
      deleteForm.action = '/admin/' + patientID + '?_method=Delete';
      deleteForm.submit();
    }
  });

  //btn update
  

</script>